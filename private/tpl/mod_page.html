<script src="{http_js}mod_page.js?{time}"></script>

<div align="left">
    <!-- START BLOCK : page_found -->
        <table>
            <tr>
                <td>
                    Ревизия: {rev}<br>
                    Страница: {page_id}<br>
                    Индекс: {index_start} - {index_end}
                </td>
                <td>
                    <!-- START BLOCK : button_edit -->
                        <a href="{link}" onclick="">
                            <img class="img_button" src="{http_img}edit.png">
                        </a>
                    <!-- END BLOCK : button_edit -->

                    <!-- START BLOCK : editor_buttons -->
                        <a href="javascript:editor.save()" onclick="">
                            <img class="img_button" src="{http_img}save.png">
                        </a>
                        <a href="{link_cancel}" onclick="">
                            <img class="img_button" src="{http_img}cancel.png">
                        </a>
                        <a href="javascript:editor.indexLineSwitch()" onclick="">
                            <img class="img_button" src="{http_img}grid.png">
                        </a>
                        <div id="messageBox" style="border: solid 2px red;
                                                    height: 25;
                                                    color: yellow;
                                                    width: max-content;
                                                    padding-left: 10;
                                                    padding-right: 10;
                                                    display: none;"></div>

                    <!-- END BLOCK : editor_buttons -->
                </td>
            </tr>
        </table>
    <!-- END BLOCK : page_found -->

    <!-- START BLOCK : not_found -->
        Индекс {cn} не найден
    <!-- END BLOCK : not_found -->

    <!-- START BLOCK : prev_page -->
        <a href="{link}" title="предыдущая страница">
            <img class="img_button" src="{http_img}arrow_left.png">
        </a>
    <!-- END BLOCK : prev_page -->

    <!-- START BLOCK : next_page -->
        <a href="{link}" onclick="" title="следующая страница">
            <img class="img_button" src="{http_img}arrow_right.png">
        </a>
    <!-- END BLOCK : next_page -->


    <div id="mainDiv" style="text-align: left">
        <!-- START BLOCK : navigator -->
            <img id="schImg"
                 style="width: {def_width}; height: {def_height}"
                 src="{http_img}pages/{sch_img}">

            <script>
                $(document).ready(function () {
                    nav = new Navigator({id},
                                        {original_width}, {original_height},
                                        {index_start}, {index_end},
                                        {offset}, {step},
                                        $$('mainDiv'), $$("schImg"));

                    $("#schImg").on("click", function (event) {
                        p = new Point(event.pageX - this.offsetLeft, event.pageY - this.offsetTop)
                        nav.onClick(p.fromScaled(nav.scale));
                    });

                    $("#schImg").on("mousemove", function (event) {
                        p = new Point(event.pageX - this.offsetLeft, event.pageY - this.offsetTop)
                        schP = p.fromScaled(nav.scale);
                        nav.onMouseMove(schP);
                    });

                    document.addEventListener("keypress", function onEvent(event) {
                        nav.keyPress(event.key);
                    });

                    <!-- START BLOCK : show_index_selector -->
                        nav.showIndexSelector({index});
                    <!-- END BLOCK : show_index_selector -->

                    <!-- START BLOCK : show_link_point_selector -->
                        nav.setHighlightLinkPoint({from_index});
                    <!-- END BLOCK : show_link_point_selector -->
                });
            </script>
        <!-- END BLOCK : navigator -->


        <!-- START BLOCK : editor -->
            <input id="editBox" size="4" type="text" style="position: absolute; display: none">

            <img id="schImg"
                 style="width: {def_width}; height: {def_height}"
                 src="{http_img}pages/{sch_img}">

            <script>
                $(document).ready(function () {
                    editor = new Editor({id},
                                        {original_width}, {original_height},
                                        {index_start}, {index_end},
                                        {offset}, {step},
                                        $$('mainDiv'), $$("schImg"),
                                        $$('editBox'), $$('messageBox'));

                    $("#schImg").on("click", function (event) {
                        p = new Point(event.pageX - this.offsetLeft, event.pageY - this.offsetTop)
                        editor.onClick(p.fromScaled(editor.scale));
                    });

                    $("#schImg").on("mousemove", function (event) {
                        p = new Point(event.pageX - this.offsetLeft, event.pageY - this.offsetTop)
                        schP = p.fromScaled(editor.scale);
                        editor.onMouseMove(schP);
                        $('#img_coordinate').html("X Coordinate: " + schP.x +
                                                  "<br/> Y Coordinate: " + schP.y);
                    });

                    document.addEventListener("keypress", function onEvent(event) {
                        editor.keyPress(event.key);
                    });
                });
            </script>

            <p id="img_coordinate" style="height: 50px"></p>
        <!-- END BLOCK : editor -->
    </div>
</div>